# Codex (OpenAI GPT-5.2) の批評

### 結論（最初に明言）
v6の「ソフトスコアリング＋Top-k提示」への転換自体は正しいが、Claude案は**確率・評価・工数の設計が破綻**している。現状のまま実装しても「当たっているか」を測れず、改善ループも回らないため、**プロダクトとして失敗する**。

### 批判的分析
**1) 論理的整合性（矛盾・前提の誤り）**
- **「確率分布を推定」は誤りである。** LLMに0–100を付けさせてsoftmaxしても、それは確率ではなく単なる正規化スコアである。確率と言うなら、校正（calibration）と検証手順が必須であり、設計に存在しない。
- **上卦・下卦の独立合成は誤りである。** v6は「上卦分布×下卦分布」で64卦順位付けする設計だが、上卦と下卦はテキスト上で強く相関する。独立仮定は体系的に誤答を作る（例：内部要因が外部結果を規定する型、相互作用が主題の型）。
- **「上卦=外部/結果、下卦=内部/原因」の固定割当は誤りである。** これは解釈上の便宜であり、入力事例の構造（語り手の視点、時間軸、主体/客体）により入れ替わる。固定すると系統的バイアスが入る。
- **類似事例分布での補正は定義不全である。** 何を類似とし、どの分布を、どう混合し、リークをどう防ぐかが未定義だ。未定義の補正は再現不能で、評価も不能である。
- **「Top-k提示→ユーザー選択」は品質指標にならない。** 選択率はUI強制で簡単に上がる。正しさの代理指標として無価値である。

**2) 実現可能性（技術・実務）**
- **実装自体は容易である。** 8クラス（八卦）×2のスコアリングと64の合成、Top-k提示はすぐ組める。
- **実務として成立しない理由はデータ設計欠落である。** 易経のマッピングは本質的に多解で、単一正解ラベル前提の「精度」を置いた瞬間に評価が崩壊する。必要なのは「多人数・多ラベル（soft label）」のゴールド定義であり、ここが空白だ。
- **工数156hは誤りである。** 400件ゴールドを80hで作る（1件12分）は、解釈ルーブリック策定、二重査読、齟齬調停、ラベル一貫性監査を一切含まない“数字合わせ”である。これではゴールドがノイズになり、モデル調整が逆に劣化する。

**3) 新規性の真偽**
- **新規性はない。** ソフトスコア→ランキング→Top-k提示→不確実時にユーザー介入は、検索・推薦・分類で標準の設計である。新規性の主張は不正確である。

**4) スケーラビリティ**
- **LLM依存のスコアリングはコストとドリフトに弱い。** プロンプト改変やモデル更新でスコア分布が変形し、過去評価が再現不能になる。運用では「バージョン固定」「回帰テスト」「校正の再学習」が必須だが計画にない。
- **類似検索補正はデータが増えるほどバイアスが増幅する。** 事例分布が偏ると、偏りが補正を通じて自己増殖する（人気卦の過剰提示）。

**5) 反例・エッジケース（破綻シナリオ）**
- **複数時間軸**（短期の障害/長期の構造変化）が混在する相談は、上卦/下卦の二分法が崩れる。
- **主体が曖昧**（自分の問題か他者環境か）が未確定な入力では、八卦スコアは不安定になる。
- **比喩・文化依存語**が多い入力で、LLM採点は説明は整うが順位が揺れる。softmaxは揺れを確率に見せかけるだけである。
- **ユーザーが誘導文**（「私は乾だと思う」等）を入れると、スコアが汚染される。防御設計がない。

**6) 代替案との比較（より優れた設計が存在する）**
- **最良の基本形は「候補生成→再ランキング」である。** 先に類似検索で20–50候補へ絞り、LLM（またはルール）で再ランキングすれば、コストと安定性が上がる。
- **上卦・下卦は独立でなく「8×8の同時予測」にすべきである。** 1回の推論で(上,下)ペアのロジット行列を出せば相互作用を表現できる。独立積は捨てるべきである。
- **確率を名乗るなら校正を入れるべきである。** 温度パラメータを“調整”と言うだけでは校正にならない。ホールドアウトで温度最適化し、ECEやBrierを測って初めて確率である。

### Claudeの意見への反論/修正
- 正しい点：**ハードゲートからランキングへ転換**、**Top-k提示**、**不確実性をUIで吸収**、**卦確定後に爻へ進む分離**は正しい。v5の「誤ると回復不能」を解消する方向性は評価する。
- 誤り：**「確率分布を推定」**は虚偽である（校正不在）。**ECE≤0.2**などの指標を掲げる資格がない。**ユーザー選択率≥90%**は品質指標として無意味である。**上卦/下卦Top-1≥55%**や**Top-1≥35%**は、正解定義と注釈一致率を示さずに数字だけ置いており、研究計画として失格である。**156h見積もり**はゴールド作成工程の現実を無視している。

### より正確な見解
- **まず「正解」を単一ラベルから撤廃せよ。** 1事例に対し複数の妥当卦が並立する前提で、専門家複数人の投票分布＝soft labelをゴールドにする。これ無しに確率・精度・MRRを語るのは誤りである。
- **モデルは独立積を捨て、(上,下)ペアを同時にスコアせよ。** 実装は「8×8のロジット行列→Top-k(64)」でよい。上/下の説明は後付けで整合させればよい。
- **Top-k提示は“常時”ではなく“不確実時のみ”にせよ。** 分布エントロピーや1位と2位のマージンが小さい時だけ追加質問で分岐する。ユーザー負担を指標で最小化する設計が必要である。
- **評価はランキング品質＋校正＋注釈一致をセットで回せ。** nDCG@k/MRRに加え、専門家間一致（合意率）を計測し、確率を名乗るなら温度スケーリング等で校正してECE/Brierを測る。  
- **工数は「注釈設計」が支配する。** 400件を12分で量産するのではなく、ルーブリック策定→二重注釈→調停→監査を前提に再見積もりせよ。ここを削る計画は必ず破綻する。
