# Claude (Anthropic) の見解

## 改善計画v8（最終版）

8回のCodexディベートで確立した全設計原則を反映。

### 確立した設計原則

1. 64卦を同時スコア（独立積ではなく）
2. soft label（複数の妥当卦を認める）
3. 条件付きユーザー関与（不確実時のみ）
4. 校正された確率（温度スケーリング+検証）
5. 統合重みは学習で決める（固定αは禁止）
6. 閾値はrisk-coverageで決める（恣意的数値は禁止）
7. 注釈指標はKrippendorffs alpha（Fleiss kappaは不適切）

### 問題の本質的定義

目標は「当てる」ではなく「誤確定を抑えつつ納得度を最大化する」

### アーキテクチャ

Stage 1: 64卦同時スコアリング
- 埋め込み+64クラス分類ヘッド
- または類似検索+再ランキング
- 出力: 64次元ロジットベクトル

Stage 2: スコア統合（学習済み重み）
- 複数シグナルを学習済みモデルで統合
- 重みは検証データで最適化（固定α廃止）
- 温度スケーリングで校正

Stage 3: 選択的予測（risk-coverage制御）
- risk-coverage曲線から閾値決定
- 目標: 誤確定率20%以下でカバレッジ最大化
- 確実→自動確定、不確実→ユーザー関与

Stage 4: 条件付きユーザー関与
- Top-k候補提示（不確実時のみ）
- 15卦フィルタは原則禁止（使用時は漏れ率定量化+救済経路）

Stage 5: 64卦確定→爻判定

### ゴールドセット設計

- 3名の注釈者が独立に妥当な卦を選択（複数選択可）
- 各卦に妥当度（1-5順序尺度）を付与
- soft label = 投票分布を正規化
- 一致指標: Krippendorffs alpha >= 0.4

### 評価指標

分布品質: KL Divergence<=1.0, Brier<=0.3
ランキング品質: nDCG@10>=0.7, MRR>=0.4
校正品質: ECE<=0.15
選択的予測: Coverage@Risk=0.2>=60%
注釈品質: Krippendorffs alpha>=0.4

### 工数見積もり: 320h

Phase 1 設計: 48h（ルーブリック策定20h含む）
Phase 2 パイロット2ラウンド: 80h
Phase 3 ゴールドセット300件: 140h
Phase 4 モデル構築: 52h

### v7からの主な修正

- Stage 1-2の矛盾解消（最初から64卦同時スコア）
- 固定alpha=0.7→学習済み重み
- 恣意的閾値→risk-coverage曲線
- Fleiss kappa→Krippendorffs alpha
- 15卦フィルタ無条件→原則禁止+救済経路
- 260h→320h（反復ループ含む）

### フォールバック

- alpha<0.3: 八卦（8クラス）に簡素化
- nDCG@10<0.5: 検索重み増加
- Coverage@Risk=0.2<40%: 目標リスク0.3に緩和