#!/usr/bin/env python3
"""卦51-60の日本語訳を追加"""
import json, copy

TRANSLATIONS = {
    "51": {
        "judgment": "雷のように衝撃がある時期です。驚いても、後には笑いがあります。百里に響く雷でも、祭祀の酒を失うことはありません。",
        "tuan": "雷が通じるのは、恐れて福があるからです。笑って語り合うのは、後に法を得るからです。百里を驚かせるのは、遠くを恐れさせるからです。鬯と匕を失わないのは、祖廟を守れるからです。出て長男として国を守ることができます。",
        "xiang": "雷が重なる形です。恐れて省みて修めることが大切です。",
        "lines": {
            "1": {"text": "雷が来て恐れますが、後には笑いがあります。吉です。", "xiang": "雷が来て恐れるのは、恐れが福をもたらすからです。笑って語るのは、後に法があるからです。"},
            "2": {"text": "雷が来て危険です。億を失うと考え、九陵に登ります。追わなくても七日で得られます。", "xiang": "雷が来て危険なのは、強いものに乗っているからです。"},
            "3": {"text": "雷がぼんやりします。雷によって行動しても問題ありません。", "xiang": "雷がぼんやりするのは、位置が正しくないからです。"},
            "4": {"text": "雷が泥に落ちます。抜け出せない状態です。", "xiang": "雷が泥に落ちるのは、まだ光っていないからです。"},
            "5": {"text": "雷が往来して危険ですが、失うことなく何かがあります。", "xiang": "雷が往来するのは危険で、大いなるものを失っています。中にあれば問題ありません。"},
            "6": {"text": "雷がぼうぜんとして見回し、進めば凶です。雷が身に及ばず近隣に及ぶなら問題ありません。婚姻には言葉があります。", "xiang": "雷がぼうぜんとするのは、中を得ていないからです。凶は隣に恐れがあるから問題ないのです。"}
        }
    },
    "52": {
        "judgment": "止まることが大切な時期です。背中で止まり、体を得ず、庭を歩いても人を見ません。問題ありません。",
        "tuan": "止まるとは止まることです。止まるべき時に止まり、行くべき時に行く。動と静を時に適うようにすれば、道が輝きます。背中で止まるのは、背中は体を得ないからです。庭を歩いても人を見ないのは、応じ合わないからです。",
        "xiang": "山が連なる形です。思いをその位から出さないことが大切です。",
        "lines": {
            "1": {"text": "つま先で止まると問題なく、永く堅実であれば有利です。", "xiang": "つま先で止まるのは、まだ正しさを失っていないからです。"},
            "2": {"text": "ふくらはぎで止まり、従う者を救えず心が楽しくありません。", "xiang": "従う者を救えないのは、まだ聞き入れて退かないからです。"},
            "3": {"text": "腰で止まり、背骨が裂けます。心が燃えるような危険があります。", "xiang": "腰で止まるのは危険で、心が燃えます。"},
            "4": {"text": "体で止まると問題ありません。", "xiang": "体で止まるのは、身を止めることです。"},
            "5": {"text": "顎で止まり、言葉に順序があれば後悔が消えます。", "xiang": "顎で止まるのは、中正だからです。"},
            "6": {"text": "敦厚に止まれば吉です。", "xiang": "敦厚な吉は、終わりまで美しいからです。"}
        }
    },
    "53": {
        "judgment": "徐々に進む時期です。女性が嫁ぐのに吉で、堅実であれば有利です。",
        "tuan": "徐々に進むことの吉は、堅実さが功を得るからです。正しい位置を得て進むことで、邦を正すことができます。剛が中を得ています。止まって従うことで動いて困窮しません。",
        "xiang": "山の上に木がある形です。徳を積み、良い風俗を改めることが大切です。",
        "lines": {
            "1": {"text": "鴻雁が水辺に徐々に進みます。若者が危険で言葉がありますが問題ありません。", "xiang": "若者の危険は義に問題がありません。"},
            "2": {"text": "鴻雁が磐石に徐々に進みます。飲み食いして楽しく吉です。", "xiang": "飲み食いして楽しいのは、飢えず満足するからです。"},
            "3": {"text": "鴻雁が陸に徐々に進みます。夫が出て戻らず、婦が孕んでも育てません。凶です。ただし寇を防ぐのに有利です。", "xiang": "夫が出て戻らないのは、群れを離れて恥ずかしいからです。婦が孕んでも育てないのは、道を失っているからです。寇を防ぐのに有利なのは、順に互いを守るからです。"},
            "4": {"text": "鴻雁が木に徐々に進みます。平らな枝を得れば問題ありません。", "xiang": "平らな枝を得れば順で従うからです。"},
            "5": {"text": "鴻雁が丘陵に徐々に進みます。婦が三年孕まず、最終的には勝てないものはありません。吉です。", "xiang": "最終的に勝てないものはないのは、志を得るからです。"},
            "6": {"text": "鴻雁が陸に徐々に進み、その羽が儀式に用いられます。吉です。", "xiang": "その羽が儀式に用いられる吉は、乱れることがないからです。"}
        }
    },
    "54": {
        "judgment": "嫁ぐ時期ですが、進めば凶で利することがありません。",
        "tuan": "嫁ぐ少女は天地の大義で、人の終始です。喜んで動けば嫁ぎ、位置が正しくありません。進めば凶なのは、位置が正しくないからです。利がないのは、弱いものが強いものに乗っているからです。",
        "xiang": "沢の上に雷がある形です。永く終わりを知り、終わることの弊害を知ることが大切です。",
        "lines": {
            "1": {"text": "嫁ぐ少女が妹として行きます。足が不自由でも歩けるなら進んで吉です。", "xiang": "嫁ぐ少女が妹として行くのは、恒常の形態です。足が不自由でも歩くのは、互いに助け合うからです。"},
            "2": {"text": "片目でも見えます。隠居者の堅実さが有利です。", "xiang": "隠居者の堅実さが有利なのは、常を変えないからです。"},
            "3": {"text": "嫁ぐ少女が妹として帰り、嫁ぎ直します。", "xiang": "嫁ぐ少女が妹として行くのは、まだ正しくないからです。"},
            "4": {"text": "嫁ぐ少女が期限を過ぎ、遅く嫁ぐのが時を待つことです。", "xiang": "期限を過ぎたのは、時を待つことです。"},
            "5": {"text": "帝乙が少女を嫁がせ、その衣装の袖は側室のものより美しくありません。月が満ちそうな時が吉です。", "xiang": "帝乙が少女を嫁がせるのは、その衣装が側室より劣るのは位置が中にあり高貴だからです。"},
            "6": {"text": "女性が籠を持っても実がなく、士が羊を刺しても血が出ません。利することがありません。", "xiang": "上に実がないのは、空の籠を持つからです。"}
        }
    },
    "55": {
        "judgment": "豊かで盛んな時期です。王に至り、憂うことはありません。日の盛りに適しています。",
        "tuan": "豊とは大きいことです。明と動が合わさって豊かです。王に至るのは大を尊ぶからで、憂うことはありません。日の盛りに適しています。天地も月も満ち欠けがあり、まして人や鬼神はなおさらです。",
        "xiang": "雷と電光が共にある形です。訴訟を断じ、刑を行うことが大切です。",
        "lines": {
            "1": {"text": "同格の主人に会っても問題なく、十日間動けません。進めば称賛されます。", "xiang": "十日間動けないのは、それを超えると災いがあるからです。"},
            "2": {"text": "豊かな帳が昼間を暗くし、北斗七星を見ます。進めば疑いがあり、誠意を持てば喜びがあります。吉です。", "xiang": "誠意を持てば喜びがあるのは、志に誠があるからです。"},
            "3": {"text": "豊かな旗が太陽を遮り、昼間でも小星を見ます。右腕を折りますが問題ありません。", "xiang": "豊かな旗が太陽を遮るのは、大事に使えないからです。右腕を折るのは、最終的に使えないからです。"},
            "4": {"text": "豊かな帳が昼間を暗くし、北斗七星を見ます。主人に会えば吉です。", "xiang": "豊かな帳が昼間を暗くするのは、位置が正しくないからです。北斗七星を見るのは暗くて明るくないからです。主人に会えば吉なのは、行動の意味があるからです。"},
            "5": {"text": "明るさが来て祝福と称賛があり、吉です。", "xiang": "六五の吉は祝福があるからです。"},
            "6": {"text": "家を豊かにしますが、家族を見ず、門を覗いても誰もおらず、三年会いません。凶です。", "xiang": "家を豊かにするのは天際に飛ぶようなもので、門を覗いても誰もいないのは自ら隠れるからです。"}
        }
    },
    "56": {
        "judgment": "旅の時期です。小さなことには通じ、堅実であれば吉です。",
        "tuan": "旅で小さく通じ、柔が外で中を得て、止まって明るさに付きます。小さなことに通じ、旅に堅実なら吉で、旅の時の意義は大きいです。",
        "xiang": "山の上に火がある形です。刑罰を明らかにし慎重に、訴訟を長引かせないことが大切です。",
        "lines": {
            "1": {"text": "旅人が細かいことにこだわると、災いを招きます。志が窮して災いを得るからです。", "xiang": "旅が細かいことにこだわるのは、志が窮して災いを得るからです。"},
            "2": {"text": "旅人が宿に着き、資金を懐にして、若い従者の忠誠を得ます。", "xiang": "若い従者の忠誠を得るのは、最終的に問題がないからです。"},
            "3": {"text": "旅人が宿を焼き、若い従者を失います。堅実であっても危険です。", "xiang": "旅が宿を焼くのは、また傷つくからです。旅に従者を失うのは、義として失うからです。"},
            "4": {"text": "旅人が場所を得て、資金と斧を得ますが心は楽しくありません。", "xiang": "旅が場所を得るのは、まだ位置を得ていないからです。資金と斧を得るのは、心がまだ快くないからです。"},
            "5": {"text": "雉を射て一矢で得、最終的には命と誉れを得ます。", "xiang": "最終的に命と誉れを得るのは、上に近づくからです。"},
            "6": {"text": "鳥が巣を焼かれ、旅人は最初は笑い後には泣きます。牛を失っても軽く考えると凶です。", "xiang": "旅が上にあるのは、義で焼かれるからです。牛を失うことを軽く考えると凶なのは、まだ聞いていないからです。"}
        }
    },
    "57": {
        "judgment": "柔らかく従う時期です。小さく通じ、どこかに行くのに有利で、偉大な人に会うことも有利です。",
        "tuan": "巽が重なり、命を行います。剛が中正に従い、志が行われます。柔がすべて剛に従います。小さく通じ、どこかに行くのに有利で、偉大な人に会います。",
        "xiang": "風が連なる形です。命を繰り返して事を行うことが大切です。",
        "lines": {
            "1": {"text": "進んだり退いたりで、武人の堅実さが有利です。志が疑っているからです。", "xiang": "進んだり退いたりするのは、志が疑っているからです。武人の堅実さが有利なのは、志を整えるからです。"},
            "2": {"text": "床の下で従い、巫医を多く用います。吉で問題ありません。", "xiang": "多くの巫医の吉は、中を得ているからです。"},
            "3": {"text": "何度も従うと恥をかきます。", "xiang": "何度も従う恥は、志が窮するからです。"},
            "4": {"text": "後悔が消え、狩りで三品を得ます。", "xiang": "狩りで三品を得るのは、功があるからです。"},
            "5": {"text": "堅実で吉、後悔が消えます。何も利がないことはありません。始めはなくても終わりがあり、変更を告げる前に三日、告げた後に三日、吉です。", "xiang": "六五の吉は位置が中正だからです。"},
            "6": {"text": "床の下で従い、資金と斧を失います。堅実であっても凶です。", "xiang": "床の下で従うのは上にあって窮するからです。資金と斧を失うのは正しさを失うからです。"}
        }
    },
    "58": {
        "judgment": "喜びの時期です。通じ、堅実であれば有利です。",
        "tuan": "喜びは楽しむことです。剛が中で柔が外にあり、喜んで堅実であることで天に応じ人に従います。民に先立てば民は苦労を忘れ、難に犯せば民は死を忘れます。喜びが民を励ますのは大きいです。",
        "xiang": "沢が連なる形です。朋友と講じ習うことが大切です。",
        "lines": {
            "1": {"text": "和らいで喜び、吉です。志が喜ばしいからです。", "xiang": "和らいで喜びの吉は、行動が疑われないからです。"},
            "2": {"text": "誠意を持って喜び、吉で後悔が消えます。信じて喜びます。", "xiang": "誠意を持って喜びの吉は、信を持って志すからです。"},
            "3": {"text": "来て喜ぶのは凶です。位置が正しくないからです。", "xiang": "来て喜ぶ凶は、位置が正しくないからです。"},
            "4": {"text": "商量して喜ぶのはまだ寧らかではありません。境界を塞いだ後に喜びがあります。", "xiang": "商量して喜ぶのは祝福があるからです。"},
            "5": {"text": "剥がすものを信じると危険があります。位置が正しいからです。", "xiang": "剥がすものを信じる危険は、位置が正しいからです。"},
            "6": {"text": "引いて喜びます。まだ輝いていません。", "xiang": "上に引いて喜ぶのは、まだ輝いていないからです。"}
        }
    },
    "59": {
        "judgment": "散らばる時期です。通じ、王が祖廟に至ります。大川を渡るのに有利で、堅実であれば有利です。",
        "tuan": "散らばって通じるのは、柔が来ても窮せず、剛が来て外にいて同じくするからです。王が祖廟に至るのは、王が中にいるからです。大川を渡るのに有利なのは、木に乗って功があるからです。",
        "xiang": "風が水上を行く形です。先王が帝を祀り、祖廟を立てました。",
        "lines": {
            "1": {"text": "馬の力で救うと吉です。初めに命を行うからです。", "xiang": "初六の吉は順っているからです。"},
            "2": {"text": "散らばって席に走れば後悔が消えます。", "xiang": "散らばって席に走るのは志を得るからです。"},
            "3": {"text": "身を散らすのは後悔がありません。志が外にあるからです。", "xiang": "身を散らすのは後悔がないのは、志が外にあるからです。"},
            "4": {"text": "群れを散らすと大吉で、散らばって丘に集まります。匪の夷が思うところです。", "xiang": "群れを散らして大吉なのは、光と大きさがあるからです。"},
            "5": {"text": "散らばって声を発し、王が居ると問題ありません。", "xiang": "王が居て問題ないのは正しい位置にあるからです。"},
            "6": {"text": "血を散らして離れると問題ありません。", "xiang": "血を散らすのは害を遠ざけるからです。"}
        }
    },
    "60": {
        "judgment": "節度を守る時期です。通じますが、苦しい節度は堅実にできません。",
        "tuan": "節度が通じるのは、剛と柔が分かれて剛が中を得ているからです。苦しい節度は堅実にできないのは、その道が窮するからです。喜んで険を行い、正しい位置で節度を行い、中正で通じます。天地が節度を持つことで四季が成り、節度をもって制度を定めれば財を傷めず民を害しません。",
        "xiang": "沢の上に水がある形です。制度を定めて徳を議することが大切です。",
        "lines": {
            "1": {"text": "戸を庭から出ませんので問題ありません。通じるべきことを知っているからです。", "xiang": "戸を庭から出ないのは、通を知るからです。"},
            "2": {"text": "門を庭から出ないと凶です。時を失っているからです。", "xiang": "門を庭から出ない凶は、時を失って極まるからです。"},
            "3": {"text": "節度がなければ嘆く者があり、問題はありません。", "xiang": "節度がなく嘆くのは、また誰の過ちでしょうか。"},
            "4": {"text": "安らかに節度を守れば通じます。節度を受け継いで通じているからです。", "xiang": "安らかに節度を守って通じるのは、道を受け継いでいるからです。"},
            "5": {"text": "甘い節度で吉があり、進めば尊敬されます。中正だからです。", "xiang": "甘い節度の吉は、居して中にあるからです。"},
            "6": {"text": "苦しい節度で堅実でも凶ですが、後悔が消えます。道が窮するからです。", "xiang": "苦しい節度で堅実で凶なのは、その道が窮するからです。"}
        }
    }
}

with open('/Users/hideakimacbookair/Library/Mobile Documents/com~apple~CloudDocs/易経変化ロジックDB/data/reference/iching_texts_ctext_legge.json', 'r', encoding='utf-8') as f:
    original = json.load(f)
with open('/Users/hideakimacbookair/Library/Mobile Documents/com~apple~CloudDocs/易経変化ロジックDB/data/reference/iching_texts_ctext_legge_ja.json', 'r', encoding='utf-8') as f:
    ja_data = json.load(f)

for hex_num, trans in TRANSLATIONS.items():
    if hex_num not in ja_data["hexagrams"]:
        hex_data = copy.deepcopy(original["hexagrams"][hex_num])
        hex_data["judgment"]["modern_ja"] = trans["judgment"]
        hex_data["tuan"]["modern_ja"] = trans["tuan"]
        hex_data["xiang"]["modern_ja"] = trans["xiang"]
        for line_num, line_trans in trans["lines"].items():
            if line_num in hex_data["lines"]:
                hex_data["lines"][line_num]["modern_ja"] = line_trans["text"]
                if "xiang" in hex_data["lines"][line_num]:
                    hex_data["lines"][line_num]["xiang"]["modern_ja"] = line_trans["xiang"]
        ja_data["hexagrams"][hex_num] = hex_data
        print(f"Added hexagram {hex_num}")

with open('/Users/hideakimacbookair/Library/Mobile Documents/com~apple~CloudDocs/易経変化ロジックDB/data/reference/iching_texts_ctext_legge_ja.json', 'w', encoding='utf-8') as f:
    json.dump(ja_data, f, ensure_ascii=False, indent=2)
print(f"Total hexagrams: {len(ja_data['hexagrams'])}")
