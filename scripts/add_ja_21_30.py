#!/usr/bin/env python3
"""卦21-30の日本語訳を追加"""
import json, copy

TRANSLATIONS = {
    "21": {
        "judgment": "障害を噛み砕いて進む時期です。問題を明確にし、決断を下すことで、前に進めます。規律を正すことが有効です。",
        "tuan": "口の中に障害物がある形です。それを噛み砕くことで、道が通じます。動きと明るさが合わさり、雷と電光のように明確な判断ができます。",
        "xiang": "雷と電光が合わさる形です。刑罰を明らかにし、法を正すことが重要な時期です。",
        "lines": {
            "1": {"text": "足かせをはめられて動けない状態ですが、これ以上悪くなることは防げます。初期段階で止められることで、問題を避けられます。", "xiang": "動けなくすることで、悪行を防ぎます。"},
            "2": {"text": "柔らかい肉を噛む程度の障害です。深く噛み込んでも問題はありません。", "xiang": "強いものの上に乗っている状態です。"},
            "3": {"text": "乾いた肉を噛むと、不快なものに出会うかもしれません。小さな後悔はありますが、大きな問題にはなりません。", "xiang": "位置が適切でないことによる困難です。"},
            "4": {"text": "骨つき肉を噛む困難がありますが、金の矢を得るような報酬もあります。困難を認識して堅実に対処すれば吉です。", "xiang": "まだ光が十分ではありませんが、堅実さが吉を生みます。"},
            "5": {"text": "乾いた肉を噛んで黄金を得る時期です。危険を意識しながら正しい道を守れば、問題ありません。", "xiang": "適切な対応を得ることで、問題を避けられます。"},
            "6": {"text": "首かせをはめられて耳を失う状態です。聞こうとしないことによる凶です。警告に耳を傾けることが大切です。", "xiang": "聞く力が明るくないことが問題です。"}
        }
    },
    "22": {
        "judgment": "外見を整え、美しく飾る時期です。ただし、外見だけで大事を成そうとするのは控えめにすることが賢明です。",
        "tuan": "柔らかさが来て強さを飾ることで、道が開けます。強さが上にあって柔らかさを飾るため、大きなことには控えめであることが良いです。天の文様と人の文化を観察することで、変化と成長を理解できます。",
        "xiang": "山の下に火がある形です。政務を明らかにしますが、裁判には慎重であることが大切です。",
        "lines": {
            "1": {"text": "足元を飾る時期です。車を捨てて歩くことが正しい選択となることもあります。派手さより実直さが大切です。", "xiang": "車に乗らないことが、正義に合っています。"},
            "2": {"text": "髭を飾るように、上の人と共に動く時期です。連携を大切にすることが良い結果を生みます。", "xiang": "上と共に動くことで、良い結果が生まれます。"},
            "3": {"text": "潤いのある装飾の時期です。正しい道を永く守れば吉です。最後まで侮られることはありません。", "xiang": "正しい道を永く守ることで、侮られることはありません。"},
            "4": {"text": "白い装飾の時期です。敵ではなく、婚姻を求める者が来ます。疑いはあっても、最終的には問題ありません。", "xiang": "婚姻を求める者であり、恨みを買うことはありません。"},
            "5": {"text": "丘や園を飾る時期です。贈り物は少なくても、最終的には吉です。控えめでも喜びがあります。", "xiang": "喜びがある時期です。"},
            "6": {"text": "白だけで飾ることで、問題を避けられます。シンプルさが最高の装飾となる時期です。", "xiang": "上にあって志を得ることができます。"}
        }
    },
    "23": {
        "judgment": "崩れ落ちる時期です。どの方向に動いても有利ではありません。静かに時を待つことが賢明です。",
        "tuan": "崩れるとは、柔らかいものが強いものを変えることです。小人が増えている時期なので、時の動きを観察し、増減の道理を理解することが大切です。",
        "xiang": "山が地についている形です。上にある者は下を手厚くすることで、自らの安定を確保できます。",
        "lines": {
            "1": {"text": "寝台の足が崩れる状態です。正しいものが損なわれ、凶です。基礎から崩れ始めています。", "xiang": "下から崩れ始めています。"},
            "2": {"text": "寝台の枠が崩れる状態です。正しいものが損なわれ、凶です。まだ仲間がいない状態です。", "xiang": "仲間がまだいない状態です。"},
            "3": {"text": "崩れる中にいても問題はありません。上下との関係が異なることで、問題を避けられます。", "xiang": "上下との違いがあることで問題を避けられます。"},
            "4": {"text": "寝台が崩れて肌にまで達する状態です。災いが間近に迫っています。", "xiang": "災いが非常に近い状態です。"},
            "5": {"text": "魚を連ねるように、宮中の人々に恩恵を与える時期です。あらゆることに利があります。", "xiang": "最終的に恨まれることはありません。"},
            "6": {"text": "大きな果実が食べられずに残っている状態です。賢い人は車を得て民に愛され、小人は住む場所を失います。", "xiang": "民に支えられて運ばれる時期です。小人は使い物になりません。"}
        }
    },
    "24": {
        "judgment": "戻ってくる時期です。出入りに問題なく、友が来て過ちもありません。七日で戻るサイクルがあり、どの方向に動いても有利です。",
        "tuan": "強いものが戻って来て、順調に動く時期です。道を繰り返し歩むことは天の運行です。強いものが成長する時期で、天地の心が見えます。",
        "xiang": "地中に雷がある形です。冬至には門を閉じて商人も諸侯も動かないように、休息の時を大切にします。",
        "lines": {
            "1": {"text": "遠くまで行かずに戻ることで、大きな後悔を避けられます。大いなる吉です。身を修めることにつながります。", "xiang": "身を修めることが、戻ることの意味です。"},
            "2": {"text": "美しく戻ることで吉が生まれます。下の徳ある者に従うことで、良い結果が得られます。", "xiang": "仁に従うことで、良い戻りができます。"},
            "3": {"text": "何度も戻ることは危うさを伴いますが、問題はありません。正義を求めることは過ちにはなりません。", "xiang": "何度も戻ることは危険ですが、義に反しないため問題ありません。"},
            "4": {"text": "中にいながら一人で戻る時期です。道に従うことで、独自の道を歩めます。", "xiang": "道に従って戻ることが大切です。"},
            "5": {"text": "誠実に戻ることで後悔はありません。中にあって自らを省みることで、良い結果が得られます。", "xiang": "中にあって自己を省みることが大切です。"},
            "6": {"text": "戻ることに迷うと凶です。災いが生じます。軍を動かせば大敗し、十年たっても立ち直れません。", "xiang": "道に反することで凶が生じます。"}
        }
    },
    "25": {
        "judgment": "無心で誠実であることが大切な時期です。正しくなければ災いがあり、動くことも有利ではありません。作為なく自然体でいることで、道が開けます。",
        "tuan": "強いものが外から来て内の主となる形です。動きと健やかさがあり、正しい中心にあって応じることで、大きく発展できます。天の命に沿うことが大切です。",
        "xiang": "天の下に雷が行く形です。万物が無心で生きており、時に合わせて万物を育むことが大切です。",
        "lines": {
            "1": {"text": "無心で進めば吉です。志を得ることができます。", "xiang": "無心で進むことで、志を達成できます。"},
            "2": {"text": "耕さずに収穫し、開墾せずに豊かな畑を得るように、思わぬ恵みがある時期です。どの方向に動いても有利です。", "xiang": "まだ富を求めていないうちに恵みが来ます。"},
            "3": {"text": "無心でいても災いがあることがあります。繋いでおいた牛を通りがかりの人が連れていくように、町の人に災いが降りかかることも。", "xiang": "通りすがりが牛を得て、町の人が災いを受けることがあります。"},
            "4": {"text": "正しく堅実であれば問題ありません。持っているものをしっかり守ることが大切です。", "xiang": "しっかり持っているものを守ることで問題を避けられます。"},
            "5": {"text": "無心であるのに病にかかることがあります。薬を使わずとも喜びがあります。自然に任せることで回復します。", "xiang": "無心の病に薬は試すべきではありません。"},
            "6": {"text": "無心であっても行動すれば災いがあり、利することはありません。時が尽きた時の災いです。", "xiang": "行動すれば災いを招く時期です。"}
        }
    },
    "26": {
        "judgment": "大きく蓄える時期です。堅実であることが有利で、家で食べずに外で仕えることが吉です。大川を渡ることも有利です。",
        "tuan": "剛健で篤実、輝きがあり、日々徳を新たにする時期です。強いものが上にあって賢者を尊び、健やかさを止められる大きな正しさがあります。賢者を養うことで天に応えられます。",
        "xiang": "天が山の中にある形です。先人の言葉と行いを多く学び、徳を蓄えることが大切です。",
        "lines": {
            "1": {"text": "危険がある時期です。止まることが有利です。むやみに進むと災いを招きます。", "xiang": "危険を冒さないことが大切です。"},
            "2": {"text": "車の軸受けが外れる状態です。中にあって問題を避けられます。", "xiang": "中にいることで問題が生じません。"},
            "3": {"text": "良い馬で追いかける時期です。困難を認識して堅実に対処し、日々鍛錬することで、どの方向に動いても有利です。", "xiang": "上と志が合っているので有利です。"},
            "4": {"text": "若い牛に横木をつける時期です。大いなる吉があります。喜びがある時期です。", "xiang": "喜びがあります。"},
            "5": {"text": "去勢した豚の牙のように、力を抑制する時期です。吉があり、祝うべき時です。", "xiang": "祝うべき時です。"},
            "6": {"text": "天の道を行く時期です。大いに通じ、道が大きく開けます。", "xiang": "道が大きく開ける時期です。"}
        }
    },
    "27": {
        "judgment": "養うことが大切な時期です。堅実であれば吉です。何を養おうとしているか、何で自分を養っているかを観察することが重要です。",
        "tuan": "養うことが正しければ吉です。自分が何を養い、何に養われているかを見ることで、天地が万物を養い、聖人が賢者と万民を養う道が見えます。養う時とその意義は大きいです。",
        "xiang": "山の下に雷がある形です。言葉に気をつけ、飲食を節制することが大切です。",
        "lines": {
            "1": {"text": "霊験あらたかな亀を捨てて、他人が食べるのを羨む状態は凶です。自分の価値を認識することが大切です。", "xiang": "他人を羨むことは、貴ぶに値しません。"},
            "2": {"text": "上から養われることを求めたり、丘から養われることを求めたりするのは、正道に反します。進めば凶です。", "xiang": "仲間から離れることになります。"},
            "3": {"text": "養う道に反しており、堅実でも凶です。十年間動かないことが有利です。", "xiang": "道に大きく反しています。"},
            "4": {"text": "上から養われることを求めるのは吉です。虎のように見つめ、追い求めれば問題ありません。", "xiang": "上からの恩恵が広がります。"},
            "5": {"text": "常道に反していますが、堅実に留まれば吉です。ただし大川を渡ることはできません。", "xiang": "上に従い順うことで吉が生まれます。"},
            "6": {"text": "養いの源となる時期です。危険ですが吉があり、大川を渡ることも有利です。大いに祝うべき時です。", "xiang": "大いに祝うべき時です。"}
        }
    },
    "28": {
        "judgment": "棟木がたわむように、過剰な負荷がかかっている時期です。どの方向に動いても有利であり、通じ道があります。",
        "tuan": "大きなものが過剰な状態です。棟木がたわむのは、本と末が弱いからです。強いものが過剰でも中にあり、柔軟に喜んで動くことで、どこに行っても利があり通じます。過剰の時とその意義は大きいです。",
        "xiang": "沢が木を覆う形です。独立して恐れず、世を避けても悶えないことが大切です。",
        "lines": {
            "1": {"text": "白い茅を敷いて、下に柔らかいものを置く時期です。丁寧に扱えば問題ありません。", "xiang": "柔らかいものが下にあり、慎重さが必要です。"},
            "2": {"text": "枯れた柳に新芽が出る時期です。老いた夫が若い妻を得るように、思わぬ良いことがあります。", "xiang": "珍しい組み合わせですが、良い結果が生まれます。"},
            "3": {"text": "棟木がたわんで凶です。支えることができない状態です。", "xiang": "支えがないため、凶となります。"},
            "4": {"text": "棟木が隆起して吉です。ただし、他のことを求めると問題があります。下に頼らないことが吉の理由です。", "xiang": "下に曲がらないことで吉が生まれます。"},
            "5": {"text": "枯れた柳に花が咲くように、老婆が若い夫を得る時期です。咎めもなく、誉れもない状態です。", "xiang": "長続きはしませんし、恥ずかしいことでもあります。"},
            "6": {"text": "頭まで水に沈むほど無謀に渡ろうとすると凶です。ただし、誰も咎めることはできません。", "xiang": "咎めることはできません。"}
        }
    },
    "29": {
        "judgment": "何度も危険が重なる時期です。誠実さを持って心を貫くことで道が開けます。行動には価値があります。",
        "tuan": "危険が重なっている状態です。水が流れて溜まらないように、危険の中を進んでも信念を失わないことが大切です。心が通じるのは強さが中にあるからで、行動に価値があるのは進んで功を得るからです。",
        "xiang": "水が重なって流れる形です。徳を常に行い、教えを習うことが大切です。",
        "lines": {
            "1": {"text": "危険が重なり、穴に入る状態は凶です。道を失っています。", "xiang": "道を失って凶となります。"},
            "2": {"text": "危険の中で危うさがありますが、小さなものを求めて得ることはできます。完全に脱出はできていません。", "xiang": "まだ中から出られていません。"},
            "3": {"text": "来ても去っても危険だらけで、休むこともできません。穴に入り、動かないことが最善です。", "xiang": "最終的に功を得ることはできません。"},
            "4": {"text": "酒と食事、土器を用いて、窓から誠意を通す時期です。最終的に問題はありません。", "xiang": "強さと柔らかさの接点です。"},
            "5": {"text": "危険がまだ満ちていませんが、やがて平らになります。問題はありません。", "xiang": "中にあってまだ大きくなっていません。"},
            "6": {"text": "縄で縛られ、茨の中に置かれる状態です。三年たっても得られず、凶です。", "xiang": "道を失って、三年の間凶が続きます。"}
        }
    },
    "30": {
        "judgment": "付着し、明るく輝く時期です。堅実であれば吉で、雌牛を育てるような従順さが良い結果をもたらします。",
        "tuan": "付着することは、太陽と月が天に、穀物と草木が地についているようなものです。柔らかいものが中正に付着することで道が開け、雌牛を養うような従順さが吉をもたらします。",
        "xiang": "明るさが二重になる形です。継続して明るく、四方を照らすことが大切です。",
        "lines": {
            "1": {"text": "足取りが乱れていますが、敬意を持って進めば問題ありません。敬意によって過ちを避けられます。", "xiang": "敬意によって過ちを避けます。"},
            "2": {"text": "黄色く輝く時期で、大いなる吉です。中道を得ています。", "xiang": "中道を得ることで大吉が生まれます。"},
            "3": {"text": "日が傾く時の輝きです。土器を叩いて歌わなければ、老いた人の嘆きとなり凶です。", "xiang": "長く続けることはできません。"},
            "4": {"text": "突然やってきて、燃え、死んで、捨てられる状態です。居場所がありません。", "xiang": "受け入れられる場所がありません。"},
            "5": {"text": "涙を流し、嘆き悲しみますが、吉です。離れて中正であることが吉の理由です。", "xiang": "王公に付くことで吉が生まれます。"},
            "6": {"text": "王が征伐に用い、首謀者を討ち取ることで称賛を得ます。ただし、一般の人には問題はありません。", "xiang": "国を正すために用います。"}
        }
    }
}

with open('/Users/hideakimacbookair/Library/Mobile Documents/com~apple~CloudDocs/易経変化ロジックDB/data/reference/iching_texts_ctext_legge.json', 'r', encoding='utf-8') as f:
    original = json.load(f)
with open('/Users/hideakimacbookair/Library/Mobile Documents/com~apple~CloudDocs/易経変化ロジックDB/data/reference/iching_texts_ctext_legge_ja.json', 'r', encoding='utf-8') as f:
    ja_data = json.load(f)

for hex_num, trans in TRANSLATIONS.items():
    if hex_num not in ja_data["hexagrams"]:
        hex_data = copy.deepcopy(original["hexagrams"][hex_num])
        hex_data["judgment"]["modern_ja"] = trans["judgment"]
        hex_data["tuan"]["modern_ja"] = trans["tuan"]
        hex_data["xiang"]["modern_ja"] = trans["xiang"]
        for line_num, line_trans in trans["lines"].items():
            if line_num in hex_data["lines"]:
                hex_data["lines"][line_num]["modern_ja"] = line_trans["text"]
                if "xiang" in hex_data["lines"][line_num]:
                    hex_data["lines"][line_num]["xiang"]["modern_ja"] = line_trans["xiang"]
        ja_data["hexagrams"][hex_num] = hex_data
        print(f"Added hexagram {hex_num}")

with open('/Users/hideakimacbookair/Library/Mobile Documents/com~apple~CloudDocs/易経変化ロジックDB/data/reference/iching_texts_ctext_legge_ja.json', 'w', encoding='utf-8') as f:
    json.dump(ja_data, f, ensure_ascii=False, indent=2)
print(f"Total hexagrams: {len(ja_data['hexagrams'])}")
